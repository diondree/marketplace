# Migration `20200427230517-image-schema-change`

This migration has been generated by Diondre Edwards at 4/27/2020, 11:05:17 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Membership" (
    "description" text  NOT NULL ,
    "id" text  NOT NULL ,
    "price" Decimal(65,30)  NOT NULL ,
    PRIMARY KEY ("id")
) 

ALTER TABLE "public"."Product" ADD COLUMN "featuredImage" text   ,
ADD COLUMN "images" text []  ;

ALTER TABLE "public"."SellerMembership" ADD COLUMN "active" boolean  NOT NULL DEFAULT true,
ADD COLUMN "membershipId" text  NOT NULL ,
ADD COLUMN "startDate" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
ADD COLUMN "updatedAt" timestamp(3)  NOT NULL ;

ALTER TABLE "public"."Store" ADD COLUMN "biography" text   ;

ALTER TABLE "public"."Image" DROP CONSTRAINT IF EXiSTS "Image_productId_fkey";

CREATE UNIQUE INDEX "SellerMembership_sellerId" ON "public"."SellerMembership"("sellerId")

ALTER TABLE "public"."SellerMembership" ADD FOREIGN KEY ("membershipId")REFERENCES "public"."Membership"("id") ON DELETE CASCADE  ON UPDATE CASCADE

DROP TABLE "public"."Image";
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200425030511-initial..20200427230517-image-schema-change
--- datamodel.dml
+++ datamodel.dml
@@ -1,64 +1,71 @@
 // datasource db {
 // provider = "mysql"
-// url = "***"
+// url      = env("MYSQL_URL")
 // }
 datasource db {
   provider = "postgres"
-  url = "***"
+  url      = "postgres://market:1marketapp@localhost:5432"
 }
 generator client {
   provider = "prisma-client-js"
 }
 // Seller Related Schemas
 model Seller {
-  id       String  @id
-  name     String
-  email    String  @unique
-  password String  @default("")
-  store    Store[]
+  id         String            @id
+  name       String
+  email      String            @unique
+  password   String            @default("")
+  store      Store[]
+  membership SellerMembership?
 }
 model Store {
-  id       String    @id
-  name     String
-  key      String?   @unique
-  seller   Seller    @relation(fields: [sellerId], references: [id])
-  sellerId String
-  products Product[]
-  active   Boolean   @default(true)
+  id        String    @id
+  name      String
+  biography String?
+  key       String?   @unique
+  seller    Seller    @relation(fields: [sellerId], references: [id])
+  sellerId  String
+  products  Product[]
+  active    Boolean   @default(true)
 }
+model Membership {
+  id          String @id
+  description String
+  price       Float
+}
+
+// paymen
 model SellerMembership {
-  id       String @id
-  seller   Seller @relation(fields: [sellerId], references: [id])
-  sellerId String
+  id           String     @id
+  active       Boolean    @default(true)
+  membershipId String
+  membership   Membership @relation(fields: [membershipId], references: [id])
+  sellerId     String
+  seller       Seller     @relation(fields: [sellerId], references: [id])
+  startDate    DateTime   @default(now())
+  updatedAt    DateTime   @updatedAt
 }
 // Product Related Schemas
 model Product {
-  id          String   @id
-  name        String
-  description String?
-  images      Image[]
-  price       Float
-  store       Store    @relation(fields: [storeId], references: [id])
-  storeId     String
-  published   Boolean  @default(true)
-  createdAt   DateTime @default(now())
-  updatedAt   DateTime @updatedAt
+  id            String   @id
+  name          String
+  description   String?
+  images        String[]
+  featuredImage String?
+  price         Float
+  store         Store    @relation(fields: [storeId], references: [id])
+  storeId       String
+  published     Boolean  @default(true)
+  createdAt     DateTime @default(now())
+  updatedAt     DateTime @updatedAt
 }
-model Image {
-  id        String  @id
-  name      String
-  url       String
-  product   Product @relation(fields: [productId], references: [id])
-  productId String
-}
-
 model Category {
   id          String   @id
   title       String
   description String
```


